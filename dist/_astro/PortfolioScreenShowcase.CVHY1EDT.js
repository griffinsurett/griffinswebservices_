import{r as t,j as l}from"./react-core.lhpfgRL0.js";import{u as Y}from"./useEngagementAutoScroll.CnVbnVAX.js";import{g as k}from"./Counter.Dw2IrPrn.js";import"./TextLogo.AY0AWOWw.js";const U=700,$=14,N=$*1e3,q=28,G=4,V=220,X=16,J=2200,K=450,Q=750;function Z(){const[o,r]=t.useState(!1);return t.useEffect(()=>{if(typeof window>"u"||typeof window.matchMedia>"u")return;const f=window.matchMedia("(min-width: 1024px)"),g=a=>{r(a.matches)};return g(f),typeof f.addEventListener=="function"?(f.addEventListener("change",g),()=>f.removeEventListener("change",g)):(f.addListener(g),()=>f.removeListener(g))},[]),o}function ee({item:o,mediaEntry:r,totalSlides:f,activeIndex:g,onCycleComplete:a,autoplayEnabled:p=!0,isActive:S,shouldUseDesktopEager:_,onImageLoad:R,deferImageRender:x=!1}){const c=t.useRef(null),[v,d]=t.useState(!1),h=t.useRef(!1),[b,M]=t.useState(!1),[O,A]=t.useState(N);t.useRef(0);const y=t.useCallback(e=>{const s=Math.max(0,e.scrollHeight-e.clientHeight);if(s<=0)return 0;const n=s/$;return!Number.isFinite(n)||n<=0?q:Math.max(q,n)},[]),C=t.useCallback(e=>{const s=Math.max(0,e.scrollHeight-e.clientHeight);if(s<=0)return N;const n=y(e);if(n<=0)return N;const T=Math.round(s/n*1e3);return!Number.isFinite(T)||T<=0?N:Math.max(N,T)},[y]),L=Y({ref:c,active:p&&b,speed:y,loop:!1,startDelay:U,resumeDelay:600,resumeOnUserInput:!0,threshold:.05,resetOnInactive:!1});t.useEffect(()=>{p&&(L.resetPosition(0),c.current?.scrollTo({top:0,left:0,behavior:"auto"}))},[p,L.resetPosition]),t.useEffect(()=>{if(x){d(!1);return}const e=c.current;if(!e)return;const s=e.querySelector("picture img")??e.querySelector("img");if(!s){d(!1);return}if(s.complete&&s.naturalHeight>0){d(!0);return}d(!1);const n=()=>d(!0);return s.addEventListener("load",n,{once:!0}),s.addEventListener("error",n,{once:!0}),()=>{s.removeEventListener("load",n),s.removeEventListener("error",n)}},[o,r,x]),t.useEffect(()=>{v&&R&&!h.current&&(h.current=!0,R())},[v,R]),t.useEffect(()=>{if(!v){M(!1);return}const e=c.current;if(!e)return;let s=!1,n=null;const T=()=>Math.max(0,e.scrollHeight-e.clientHeight)>G,m=()=>{s||(s=!0,n?.(),n=null,M(!0))},I=()=>{if(typeof ResizeObserver>"u"){m();return}let u=null,P=e.scrollHeight;const z=()=>{u||(u=window.setTimeout(()=>{u=null,m()},V))},W=()=>{u&&(window.clearTimeout(u),u=null)},F=new ResizeObserver(()=>{const H=e.scrollHeight;Math.abs(H-P)>X&&(P=H,W()),z()});F.observe(e),z(),n=()=>{F.disconnect(),u&&(window.clearTimeout(u),u=null)}};if(T())I();else if(typeof ResizeObserver<"u"){const u=new ResizeObserver(()=>{T()&&(u.disconnect(),I())});u.observe(e),n=()=>u.disconnect()}else m();const B=window.setTimeout(()=>{m()},J);return()=>{n?.(),window.clearTimeout(B)}},[v]),t.useEffect(()=>{if(!b||!p){A(N);return}const e=c.current;if(!e)return;const s=()=>A(C(e));s();const n=typeof ResizeObserver<"u"?new ResizeObserver(()=>s()):null;return n?.observe(e),()=>n?.disconnect()},[b,C]),t.useEffect(()=>{if(!b||!p||f<=1||L.paused)return;const e=U+O+K,s=window.setTimeout(()=>a(),e);return()=>window.clearTimeout(s)},[p,b,a,O,f,L.paused]),t.useEffect(()=>{},[b,S]);const E=k(o.featuredImage)||k(o.bannerImage)||k(o.image)||"",j=!!(r?.desktopEager&&_),D=j?"eager":r?.loading??"lazy",i=j?"high":r?.fetchPriority??"auto",w=()=>x?l.jsx("div",{className:"flex h-full w-full items-center justify-center bg-black/40"}):r?.sources?.length?l.jsxs("picture",{children:[r.sources.map((e,s)=>l.jsx("source",{srcSet:e.srcSet,sizes:e.sizes??r.sizes,type:e.type},`${o.slug??o.id??s}-source-${s}`)),l.jsx("img",{src:r.src,srcSet:r.srcSet,sizes:r.sizes,alt:r.alt||o.alt||o.title||"Project preview",width:r.width,height:r.height,loading:D,decoding:r.decoding??"async",fetchPriority:i,draggable:!1,className:"block h-auto min-h-full w-full select-none object-cover object-top"})]}):r?.src?l.jsx("img",{src:r.src,srcSet:r.srcSet,sizes:r.sizes,alt:r.alt||o.alt||o.title||"Project preview",width:r.width,height:r.height,loading:D,decoding:r.decoding??"async",fetchPriority:i,draggable:!1,className:"block h-auto min-h-full w-full select-none object-cover object-top"}):E?l.jsx("img",{src:E,alt:o.alt||o.title||"Project preview",loading:j?"eager":"lazy",draggable:!1,className:"block h-auto min-h-full w-full select-none object-cover object-top",decoding:"async",fetchPriority:j?"high":"auto"}):l.jsx("div",{className:"flex h-full w-full items-center justify-center bg-gradient-to-b from-bg2 via-bg to-bg/80 text-white/30",children:"Preview coming soon"});return l.jsx("div",{className:"relative h-full w-full",children:l.jsxs("div",{className:"relative h-full bg-bg3",children:[l.jsx("div",{className:"flex flex-col gap-3 border-b border-white/10 px-4 py-3 text-white/70 sm:flex-row sm:items-center sm:justify-between",children:l.jsx("div",{className:"flex items-center gap-3 text-xs uppercase tracking-[0.35em] text-white/50",children:l.jsxs("span",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"h-3 w-3 rounded-full bg-gray-800"}),l.jsx("span",{className:"h-3 w-3 rounded-full bg-gray-800"}),l.jsx("span",{className:"h-3 w-3 rounded-full bg-gray-800"})]})})}),l.jsx("figure",{ref:c,className:"relative h-full overflow-y-auto overscroll-contain bg-black/40",style:{WebkitOverflowScrolling:"touch"},children:w()}),!1]})})}function le({items:o=[],className:r="",mediaEntries:f=[],staticContainerId:g}){const a=t.useMemo(()=>Array.isArray(o)?o:[],[o]),p=t.useMemo(()=>Array.isArray(f)?f:[],[f]),[S,_]=t.useState(0),[R,x]=t.useState(null),[c,v]=t.useState("idle"),d=t.useRef(null),h=t.useRef(null),b=Z(),[M,O]=t.useState(!1),A=t.useRef(!1),[y,C]=t.useState(!1);t.useEffect(()=>{C(!0)},[]);const L=t.useCallback(()=>{if(A.current)return;A.current=!0;const i=g?document.getElementById(g):null;requestAnimationFrame(()=>{requestAnimationFrame(()=>{i&&(i.classList.add("opacity-0","pointer-events-none"),setTimeout(()=>{i.style.display="none"},500)),O(!0)})})},[g]);t.useEffect(()=>{if(!a.length){_(0),x(null),v("idle");return}_(i=>i>=a.length?0:i)},[a.length]),t.useEffect(()=>()=>{d.current&&(window.clearTimeout(d.current),d.current=null),h.current&&(cancelAnimationFrame(h.current),h.current=null)},[]);const E=t.useCallback(i=>{typeof window>"u"||(x(S),_(i),v("pre"),h.current&&(cancelAnimationFrame(h.current),h.current=null),h.current=requestAnimationFrame(()=>{h.current=requestAnimationFrame(()=>{v("animating")})}),d.current&&(window.clearTimeout(d.current),d.current=null),d.current=window.setTimeout(()=>{v("idle"),x(null)},Q))},[S]),j=t.useCallback(()=>{if(!a.length||a.length<=1||c!=="idle")return;const i=(S+1)%a.length;E(i)},[S,a.length,E,c]);if(!a.length)return null;const D="absolute inset-0 transition-transform transition-opacity duration-[750ms] ease-[cubic-bezier(0.4,0,0.2,1)]";return l.jsx("div",{className:`relative h-full ${r}`.trim(),children:l.jsx("div",{className:"relative h-full w-full overflow-hidden rounded-lg",children:a.map((i,w)=>{const e=w===S,s=w===R,n=e||s&&c!=="idle";if(!(e||s&&c!=="idle"))return null;let m="translate-x-full";return s&&c!=="idle"?m="-translate-x-full":e&&(c==="idle"||R===null?m="translate-x-0":c==="pre"?m="translate-x-full":m="translate-x-0"),l.jsx("div",{className:`${D} shadow-2xl ${m} ${n?"opacity-100":"opacity-0 pointer-events-none"}`,"aria-hidden":e?"false":"true",children:l.jsx(ee,{item:i,mediaEntry:p[w],totalSlides:a.length||1,activeIndex:w,onCycleComplete:j,autoplayEnabled:e&&c==="idle"&&M,isActive:e,shouldUseDesktopEager:b,onImageLoad:w===0?L:void 0,deferImageRender:w===0&&!y})},i.slug??i.id??w)})})})}export{le as default};
