---
// src/components/ContentRenderer/variants/TestimonialGridVariant.astro
/**
 * Testimonial Grid Variant - Static 2-column grid layout for testimonials
 * Uses the same TestimonialCard component as the carousel but renders statically
 */
import type { BaseVariantProps } from "../ContentRenderer.types";
import SectionHeader from "@/components/SectionHeader.astro";
import TestimonialCard from "@/components/LoopComponents/TestimonialCard";
import { toArray } from "@/utils/array";

interface Props extends BaseVariantProps {
  columns?: 1 | 2;
  gap?: "sm" | "md" | "lg" | "xl";
}

const {
  items = [],
  title,
  heading,
  description,
  className = "",
  collectionTitle,
  id,
  columns = 2,
  gap = "lg",
} = Astro.props as Props;

const safeItems = toArray(items);

const gapClasses = {
  sm: "gap-4",
  md: "gap-6",
  lg: "gap-8",
  xl: "gap-10",
};

const columnClasses = {
  1: "grid-cols-1",
  2: "grid-cols-1 lg:grid-cols-2",
};

const getRingDuration = (item: Record<string, any>) =>
  typeof item?.ringDuration === "number" ? item.ringDuration : 800;
---

<section
  id={id}
  class={`outer-section relative ${className}`.trim()}
>
  <div class="inner-section">
    {(title || collectionTitle || description || heading) && (
      <SectionHeader
        className="text-section"
        headingClassName="mb-6"
        descriptionClassName="large-text"
      />
    )}

    {safeItems.length > 0 && (
      <ul class={`grid ${columnClasses[columns]} ${gapClasses[gap]} list-none`}>
        {safeItems.map((item) => (
          <li>
            <TestimonialCard
              item={item}
              ringDuration={getRingDuration(item)}
              className="h-full"
            />
          </li>
        ))}
      </ul>
    )}
  </div>
</section>
