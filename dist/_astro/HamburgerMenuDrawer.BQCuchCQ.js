import{j as t,r as i}from"./react-core.CCsFRpYT.js";import{M as y}from"./Modal.YXayxnGV.js";import{B as _}from"./accordion.eYIloHZ-.js";import{I as R}from"./ui-primitives.Co27DBE-.js";import"./visibility-hooks.CpOETZYp.js";import"./engagement-hooks.D1x6yBdD.js";const v="__GREASTRO_CLIENT_CLICK_HANDLERS__",I="greastro-custom-hydrations",C=()=>{const e=globalThis;return e[v]||(e[v]=new Map),e[v]},L=()=>{const e=globalThis;return e.__GREASTRO_CLIENT_CLICK_PENDING__||(e.__GREASTRO_CLIENT_CLICK_PENDING__=new Map),e.__GREASTRO_CLIENT_CLICK_PENDING__},S=(e,s)=>{const r=L(),o=r.get(e);if(o?.length){r.delete(e);for(const a of o)try{a(s)}catch{}}},T=e=>{typeof window>"u"||window.dispatchEvent(new CustomEvent(I,{detail:{key:e}}))},O=(e,s)=>{const r=()=>{const c=C().get(e);!c||c!==s||(S(e,s.handler),T(e))},o=typeof window<"u"&&typeof window.requestAnimationFrame=="function"?window:null;if(o){o.requestAnimationFrame(()=>{o.requestAnimationFrame(()=>{r()})});return}if(typeof setTimeout=="function"){setTimeout(r,0);return}r()},A=(e,s)=>{if(!e)return;const r=C(),o={handler:s};r.set(e,o),O(e,o)},B=(e,s)=>{if(!e)return;const r=C(),o=r.get(e);!o||o.handler!==s||r.delete(e)};function $({title:e,url:s,children:r=[],openInNewTab:o=!1,onNavigate:a,onOpenSubmenu:c}){const u=r.length>0,d=()=>{u&&c?.({title:e,items:r})},b=()=>{if(s){a();return}d()};return u?t.jsx("li",{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(_,{variant:"menuItemButton",className:"hover-emphasis-text inline-flex items-center gap-2 text-left",onClick:b,...s?{href:s,target:o?"_blank":void 0,rel:o?"noopener noreferrer":void 0}:{type:"button"},children:e}),t.jsx("button",{type:"button",onClick:d,"aria-label":`View submenu for ${e}`,className:"text-text",children:t.jsx(R,{icon:"lu:chevron-right",size:"md",className:"w-6 h-6"})})]})}):t.jsx("li",{children:t.jsx(_,{variant:"menuItemButton",href:s||"#",onClick:a,target:o?"_blank":void 0,rel:o?"noopener noreferrer":void 0,className:"hover-emphasis-text",children:e})})}function G({isOpen:e,onChange:s,className:r="",ariaLabel:o="Toggle menu",hamburgerTransform:a=!0,...c}){const u=a&&e;return t.jsxs("button",{type:"button","aria-label":o,"aria-expanded":e,onClick:()=>s(!e),className:`group relative h-6 w-7 cursor-pointer flex flex-col justify-between items-start text-text hover:text-heading ${r}`.trim(),...c,children:[t.jsx("span",{className:`block h-[0.5px] w-full bg-current transition-all duration-300 ${u?"absolute top-1/2 -translate-y-1/2 rotate-45":""}`}),t.jsx("span",{className:`block h-[0.5px] bg-current transition-all duration-300 ${u?"opacity-0 w-full":"opacity-100 w-5 group-hover:w-full"}`}),t.jsx("span",{className:`block h-[0.5px] w-full bg-current transition-all duration-300 ${u?"absolute top-1/2 -translate-y-1/2 -rotate-45":""}`})]})}function V({items:e,className:s="",hamburgerTransform:r=!0,closeButton:o=!1,triggerId:a="mobile-menu-toggle",useExternalTrigger:c=!1,clientClickHandlerKey:u}){const[d,b]=i.useState(!1),[h,w]=i.useState(()=>[{title:"Main Menu",items:e}]),E=i.useRef(a);E.current=a;const p=i.useCallback(()=>{w([{title:"Main Menu",items:e}])},[e]);i.useEffect(()=>{p()},[p]);const g=i.useCallback(n=>{const l=document.getElementById(E.current);l&&l.setAttribute("aria-expanded",String(n))},[]),m=i.useCallback(n=>{b(l=>{const f=typeof n=="boolean"?n:!l;return f||p(),g(f),f})},[p,g]);i.useEffect(()=>{g(d)},[d,g]);const N=i.useRef(m);N.current=m,i.useEffect(()=>{if(!u)return;const n=()=>(N.current(),!0);return A(u,n),()=>B(u,n)},[u]),i.useEffect(()=>(console.log("[MenuDrawer] Component MOUNTED"),()=>{console.log("[MenuDrawer] Component UNMOUNTED")}),[]),i.useEffect(()=>{if(console.log("[MenuDrawer] Direct click effect running",{useExternalTrigger:c,triggerId:a}),!c){console.log("[MenuDrawer] useExternalTrigger is false, skipping listener");return}const n=document.getElementById(a);if(console.log("[MenuDrawer] Button element:",n?"found":"NOT FOUND",a),!n){console.warn("[MenuDrawer] WARNING: Button not found, cannot attach click listener");return}const l=x=>{console.log("[MenuDrawer] Direct click handler fired at",new Date().toISOString()),N.current()};n.addEventListener("click",l),console.log("[MenuDrawer] Click listener ATTACHED to button");const f=setInterval(()=>{document.getElementById(a)||console.warn("[MenuDrawer] WARNING: Button no longer in DOM!")},5e3);return()=>{console.log("[MenuDrawer] Click listener REMOVED from button"),clearInterval(f),n.removeEventListener("click",l)}},[a,c]);const M=()=>{m(!1)},j=(n,l)=>{l?.length&&w(f=>[...f,{title:n,items:l}])},k=()=>{w(n=>n.length>1?n.slice(0,-1):n)},D=(h.length-1)*100;return t.jsxs(t.Fragment,{children:[!c&&t.jsx(G,{isOpen:d,onChange:n=>m(n),hamburgerTransform:r,ariaLabel:d?"Close menu":"Open menu",id:a}),t.jsx(y,{isOpen:d,onClose:()=>m(!1),position:"center",className:`w-full max-w-full h-full bg-gradient p-0 rounded-none transform transition-transform duration-300 ease-out ${d?"translate-y-0":"translate-y-full"}`,overlayClass:`bg-black/50 transition-opacity duration-300 ${d?"opacity-100":"opacity-0"}`,closeButton:o,ariaLabel:"Mobile navigation menu",ssr:!1,children:t.jsx("nav",{className:`${s} h-full w-full flex flex-col justify-center overflow-hidden`,"aria-label":"Mobile navigation",children:t.jsx("div",{className:"inner-section my-auto py-4",style:{maxHeight:"calc(100vh - 6rem)"},children:t.jsx("div",{className:"relative w-full h-full overflow-hidden",children:t.jsx("div",{className:"flex h-full transition-transform duration-300 ease-in-out",style:{transform:`translateX(-${D}%)`},children:h.map((n,l)=>t.jsxs("div",{className:"w-full flex-shrink-0 h-full flex flex-col relative","aria-hidden":l!==h.length-1,children:[l>0&&t.jsxs("button",{type:"button",onClick:k,className:"flex items-center gap-2 text-text hover:underline absolute left-0 top-0","aria-label":`Go back to ${h[l-1]?.title??"previous menu"}`,children:[t.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),t.jsx("div",{className:`flex-1 overflow-y-auto overflow-x-hidden pr-2 ${l>0?"pt-12":""}`,children:t.jsx("ul",{className:"menu-item-spacing pb-10",children:n.items.map(f=>t.jsx($,{...f,onNavigate:M,onOpenSubmenu:x=>j(x.title,x.items)},f.slug||f.id))})})]},`${n.title}-${l}`))})})})})})]})}export{V as default};
