import{r as e,j as x}from"./react-core.EkFKhCmS.js";import{u as ne,e as se,a as oe,f as ae,c as le}from"./useVisibility.CSoA3ZaV.js";import{g as Z,u as ce,L as ie,R as ue}from"./useCarouselAutoplay.D1rm-qMM.js";import{u as fe}from"./useViewAnimation.CoM8gNl1.js";import"./useEngagementAutoplay.DpKITCWd.js";function de({ref:t,active:S=!1,speed:$=40,cycleDuration:_=0,loop:F=!1,startDelay:z=1500,resetOnInactive:H=!0}){const T=e.useRef(null),I=e.useRef(0),M=e.useRef(null),u=e.useRef(0),f=e.useRef(!1),a=e.useRef(!1),p=e.useRef(null),[h,D]=e.useState(0),R=e.useCallback(o=>{if(_&&_>0){const n=Math.max(0,o.scrollHeight-o.clientHeight);return n>0?n/_:0}return typeof $=="function"?Math.max(1,$(o)):Number($)||0},[_,$]),g=e.useCallback(()=>{T.current&&cancelAnimationFrame(T.current),T.current=null,I.current=0},[]),b=e.useCallback(()=>{M.current&&(clearTimeout(M.current),M.current=null)},[]),C=e.useCallback(()=>{a.current=!0,p.current&&(cancelAnimationFrame(p.current),p.current=null),p.current=requestAnimationFrame(()=>{a.current=!1,p.current=null})},[]),r=e.useCallback(o=>{if(!S)return;const n=t.current;if(!n)return;const v=I.current||o,E=Math.min(.05,Math.max(0,(o-v)/1e3));I.current=o;const w=Math.max(0,n.scrollHeight-n.clientHeight);if(w<=0){T.current=requestAnimationFrame(r);return}u.current===0&&n.scrollTop>0&&(u.current=n.scrollTop);const q=R(n)*E;if(u.current=Math.min(w,u.current+q),C(),n.scrollTo({top:u.current,left:0,behavior:"auto"}),u.current>=w-.5)if(F)u.current=0,n.scrollTo({top:0,left:0,behavior:"auto"});else{g();return}T.current=requestAnimationFrame(r)},[S,g,F,C,t,R]),m=e.useCallback(()=>{g();const o=t.current;o&&(u.current=o.scrollTop||0,f.current=!0,T.current=requestAnimationFrame(r))},[g,t,r]),O=e.useCallback(()=>{g()},[g]),k=e.useCallback(()=>{const o=t.current;o&&(u.current=0,o.scrollTo({top:0,left:0,behavior:"auto"}))},[t]);return e.useEffect(()=>(g(),b(),S&&(f.current?m():M.current=setTimeout(()=>{S&&m()},Math.max(0,z))),()=>{g(),b()}),[S,z,m,g,b,h]),e.useEffect(()=>{H&&(S||(f.current=!1,g(),b(),a.current=!1,u.current=0,t.current?.scrollTo({top:0,left:0,behavior:"auto"})))},[S,g,b,t,H]),e.useEffect(()=>{const o=t.current;if(!o||typeof ResizeObserver>"u")return;let n=Math.max(0,o.scrollHeight-o.clientHeight);const v=new ResizeObserver(()=>{const E=Math.max(0,o.scrollHeight-o.clientHeight);E>n+1&&(n=E,D(w=>w+1))});return v.observe(o),()=>v.disconnect()},[t]),e.useEffect(()=>()=>{g(),b(),p.current&&(cancelAnimationFrame(p.current),p.current=null),a.current=!1},[g,b]),{startNow:m,stopNow:O,resetPosition:k,isAnimating:()=>!!T.current,hasStartedThisCycle:()=>f.current,getCurrentPosition:()=>u.current,internalScrollRef:a,getMetrics:()=>{const o=t.current,n=o?Math.max(0,o.scrollHeight-o.clientHeight):0,v=o?o.scrollTop:0,E=n>0?v/n:0;return{top:v,max:n,progress:E,animating:!!T.current,started:f.current,internalGuard:a.current}}}}function me({ref:t,active:S=!1,speed:$=40,cycleDuration:_=0,loop:F=!1,startDelay:z=1500,resumeDelay:H=900,resumeOnUserInput:T=!0,threshold:I=.3,visibleRootMargin:M="0px",resetOnInactive:u=!0}){const f=e.useRef(null),a=e.useRef(!1),[p,h]=e.useState(!1),[D,R]=e.useState(!1),[g,b]=e.useState(!1),C=ne(t,{threshold:I,rootMargin:M}),r=de({ref:t,active:S&&C&&!p,speed:$,cycleDuration:_,loop:F,startDelay:z,resetOnInactive:u}),m=e.useCallback(()=>{f.current&&(clearTimeout(f.current),f.current=null),R(!1)},[]),O=e.useCallback(()=>{h(!0),m()},[m]),k=e.useCallback(()=>{T&&(a.current||(m(),R(!0),f.current=setTimeout(()=>{a.current||(R(!1),h(!1))},Math.max(0,H))))},[m,H,T]),o=e.useCallback(w=>{const A=t.current;A&&A.dispatchEvent(new CustomEvent("autoscroll-user",{bubbles:!0,detail:{phase:w}}))},[t]),n=e.useCallback(()=>{a.current=!0,b(!0),O(),o("start")},[o,O]),v=e.useCallback(()=>{a.current=!1,b(!1),o("end"),k()},[o,k]),E=e.useCallback(()=>{a.current=!0,b(!0)},[]);return se({elementRef:t,tapThreshold:8,longPressDelay:600,onTouchStart:n,onTouchMove:(w,A)=>{A.moved&&n()},onTouchEnd:v,onLongPress:n,preventDefaultOnTouch:!1}),oe({elementRef:t,scrollThreshold:1,debounceDelay:80,trustedOnly:!0,internalFlagRef:r.internalScrollRef,wheelSensitivity:1,onScrollStart:n,onScrollActivity:E,onWheelActivity:n,onScrollEnd:v}),ae({elementRef:t,onPointerDown:n,onPointerMove:(w,A)=>{A.moved&&n()},onPointerUp:v}),e.useEffect(()=>{const w=t.current;if(!w)return;const A=160,q=160;let P=null,N=null;const W=()=>{r.internalScrollRef.current||(n(),P&&clearTimeout(P),P=setTimeout(v,A))},Y=()=>{n(),N&&clearTimeout(N),N=setTimeout(v,q)};return w.addEventListener("scroll",W,{passive:!0}),w.addEventListener("wheel",Y,{passive:!0}),()=>{w.removeEventListener("scroll",W),w.removeEventListener("wheel",Y),P&&clearTimeout(P),N&&clearTimeout(N)}},[r.internalScrollRef,v,n,t]),e.useEffect(()=>{u&&(!S||!C)&&(a.current=!1,b(!1),h(!1),m())},[S,C,u,m]),e.useEffect(()=>()=>{m(),a.current=!1,b(!1)},[m]),{inView:C,paused:p,resumeScheduled:D,engaged:g,pauseNow:O,resumeNow:()=>{m(),h(!1)},startNow:r.startNow,stopNow:r.stopNow,resetPosition:r.resetPosition,isAnimating:r.isAnimating,hasStartedThisCycle:r.hasStartedThisCycle,getCurrentPosition:r.getCurrentPosition,getMetrics:r.getMetrics}}const V=1500,te=30,U=te*1e3,he=U*4,ee=18,ge=60,pe=3e3,be=6,ve=260,xe=18;function Se({item:t,i:S,activeIndex:$,itemsLength:_,centerW:F,centerH:z,sideW:H,sideH:T,tx:I,onSelect:M,mediaChild:u}){const f=e.useRef(null),a=S-$,[p,h]=e.useState(!1),[D,R]=e.useState(!1),[g,b]=e.useState(U),C=e.useMemo(()=>a===0?"center":a===-1||a===_-1?"left":a===1||a===-(_-1)?"right":"hidden",[a,_]),r=C==="center",m=r?"translate(-50%, 0)":"translate(-50%, -50%)",O=e.useCallback(s=>{const c=Math.max(0,s.scrollHeight-s.clientHeight);if(c<=0)return 0;const l=c/te;return!Number.isFinite(l)||l<=0?ee:Math.min(ge,Math.max(ee,l))},[]),k=e.useCallback(s=>{const c=Math.max(0,s.scrollHeight-s.clientHeight);if(c<=0)return U;const l=O(s);if(l<=0)return U;const L=Math.round(c/l*1e3);return!Number.isFinite(L)||L<=0?U:Math.min(he,Math.max(U,L))},[O]);me({ref:f,active:r&&p,speed:O,loop:!1,startDelay:V,resumeDelay:900,resumeOnUserInput:!0,threshold:.1,resetOnInactive:!0});const[o,n]=e.useState(0);e.useEffect(()=>{if(!r)return;let s=null;const c=()=>{const l=f.current;if(l){const L=Math.max(0,l.scrollHeight-l.clientHeight),j=L>0?l.scrollTop/L*100:0;n(Math.round(j))}s=requestAnimationFrame(c)};return s=requestAnimationFrame(c),()=>{s&&cancelAnimationFrame(s)}},[r]),e.useEffect(()=>{if(!r||!D){h(!1),b(U);return}const s=f.current;if(!s)return;let c=!1,l=null;const L=()=>Math.max(0,s.scrollHeight-s.clientHeight)>be,j=()=>{c||(c=!0,l?.(),l=null,h(!0))},i=()=>{if(typeof ResizeObserver>"u"){j();return}let y=null,G=s.scrollHeight;const J=()=>{y||(y=window.setTimeout(()=>{y=null,j()},ve))},re=()=>{y&&(window.clearTimeout(y),y=null)},K=new ResizeObserver(()=>{const Q=s.scrollHeight;Math.abs(Q-G)>xe&&(G=Q,re()),J()});K.observe(s),J(),l=()=>{K.disconnect(),y&&(window.clearTimeout(y),y=null)}};let d=null;L()?i():typeof ResizeObserver<"u"?(d=new ResizeObserver(()=>{L()&&(d?.disconnect(),d=null,i())}),d.observe(s)):j();const X=window.setTimeout(()=>{j()},pe);return()=>{d?.disconnect(),l?.(),X&&window.clearTimeout(X)}},[r,D]),e.useEffect(()=>{if(!r||!p){b(U);return}const s=f.current;if(!s)return;const c=()=>{b(k(s))};c();const l=typeof ResizeObserver<"u"?new ResizeObserver(()=>c()):null;return l?.observe(s),()=>l?.disconnect()},[r,p,k]),e.useEffect(()=>{if(!r||!p||typeof window>"u")return;const s=f.current;if(!s)return;const c=j=>{s.dispatchEvent(new CustomEvent("autoscroll-user",{bubbles:!0,detail:{phase:j}}))},l=window.setTimeout(()=>{c("start")},V),L=window.setTimeout(()=>{c("end")},V+g);return()=>{window.clearTimeout(l),window.clearTimeout(L),c("end")}},[r,p,g]);const v="absolute left-1/2 overflow-hidden shadow-[0_25px_50px_-12px_rgba(0,0,0,0.5)] transition-all duration-700 ease-[cubic-bezier(0.4,0,0.2,1)] will-change-transform bg-gray-900";let E={width:`${H}px`,height:`${T}px`,transform:`${m} scale(0)`,zIndex:10,opacity:0,pointerEvents:"none"};r?E={width:`${F}px`,height:`${z}px`,transform:`${m} scale(1) rotateY(0deg)`,zIndex:30,opacity:1}:C==="left"?E={width:`${H}px`,height:`${T}px`,transform:`${m} translateX(-${I}px) scale(0.9) rotateY(22deg)`,zIndex:20,opacity:.5,filter:"brightness(0.75)"}:C==="right"&&(E={width:`${H}px`,height:`${T}px`,transform:`${m} translateX(${I}px) scale(0.9) rotateY(-22deg)`,zIndex:20,opacity:.5,filter:"brightness(0.75)"});const w="w-full h-full bg-gray-900 overflow-y-auto overscroll-auto touch-pan-y m-0 p-0 relative",A="w-full h-full bg-gray-900 overflow-hidden pointer-events-none select-none m-0 p-0 relative",q=r?{WebkitOverflowScrolling:"touch",overscrollBehaviorY:"auto"}:void 0,P=()=>{const s=Z(t.featuredImage)||Z(t.bannerImage)||Z(t.image)||"";if(t.imageSources){if(r&&t.imageSources.center)return t.imageSources.center;if((C==="left"||C==="right")&&t.imageSources.side)return t.imageSources.side;if(t.imageSources.mobile)return t.imageSources.mobile}return s},N=()=>t.dimensions?.aspectRatio&&z>0?{objectFit:"cover",objectPosition:"center top"}:{objectFit:"cover",objectPosition:"center top"},W=P(),Y=t.alt||t.title||"Project preview",B=e.useMemo(()=>{if(!u)return;if(!e.isValidElement(u))return u;if(!u.props?.["data-portfolio-placeholder"])return u},[u]);return e.useEffect(()=>{if(!r){R(!1);return}const s=f.current;if(!s)return;const c=s.querySelector("picture img")??s.querySelector("img");if(!c){R(!0);return}const l=()=>R(!0);if(c.complete&&c.naturalHeight>0){R(!0);return}return R(!1),c.addEventListener("load",l,{once:!1}),c.addEventListener("error",l,{once:!1}),()=>{c.removeEventListener("load",l),c.removeEventListener("error",l)}},[r,B,W]),x.jsxs("div",{className:`${v} ${r?"top-0":"top-1/2"}`,style:E,"data-carousel-item":!0,"data-index":S,"data-active":r?"true":"false",onClick:()=>{r||M(S)},children:[x.jsx("figure",{ref:f,className:r?w:A,style:q,"aria-hidden":r?"false":"true",tabIndex:r?0:-1,children:B||(W?x.jsx("img",{src:W,alt:Y,loading:S===0?"eager":"lazy",draggable:!1,className:"block w-full h-auto min-h-full select-none",style:N(),decoding:"async"}):x.jsx("div",{className:"flex h-full w-full bg-gradient-to-b from-bg2 via-bg to-bg/80"}))}),!1]})}function Ce({items:t=[],defaultIndex:S=0,autoplay:$=!0,autoAdvanceDelay:_=5e3,showArrows:F=!0,showDots:z=!0,drag:H=!1,className:T="",children:I}){const M=e.useRef(null),[u,f]=e.useState(S),[a,p]=e.useState(0),h=e.useMemo(()=>Array.isArray(t)?t:[],[t]),D=e.useMemo(()=>e.Children.toArray(I??[]),[I]),R=a>0;e.useLayoutEffect(()=>{if(typeof window>"u")return;const i=M.current;if(!i)return;const d=()=>{const y=i.getBoundingClientRect().width;y&&y!==a&&p(y)};d();const X=new ResizeObserver(d);return X.observe(i),window.addEventListener("resize",d,{passive:!0}),()=>{X.disconnect(),window.removeEventListener("resize",d)}},[a]);const g=fe({ref:M,duration:500,delay:0,easing:"cubic-bezier(0.4, 0, 0.2, 1)",threshold:.1,rootMargin:"0px 0px -20% 0px"}),{scopeId:b}=ce({containerRef:M,totalItems:h.length,currentIndex:u,setIndex:f,autoplay:$,autoplayTime:_}),C=()=>{const i=a;return i<640?{centerW:280,centerH:190,sideW:180,sideH:120}:i<768?{centerW:340,centerH:230,sideW:220,sideH:150}:i<1024?{centerW:460,centerH:310,sideW:290,sideH:190}:i<1280?{centerW:680,centerH:450,sideW:420,sideH:290}:{centerW:860,centerH:540,sideW:520,sideH:360}},r=i=>{const d=a,y=-(d>=1536?72:d>=1280?56:d>=1024?40:20);return d/2-i/2-y},{centerW:m,centerH:O,sideW:k,sideH:o}=R?C():{centerW:0,centerH:0,sideW:0,sideH:0},n=R?r(k):0,v=()=>f(i=>i===0?h.length-1:i-1),E=()=>f(i=>i===h.length-1?0:i+1),A=(a>=768?48:40)/2,q=a>=1024?20:16,P=a>=1280,N=m/2+A+q,W=P?`calc(50% - ${n}px)`:`calc(50% - ${N}px)`,Y=P?`calc(50% + ${n}px)`:`calc(50% + ${N}px)`,B=e.useRef(null),s=e.useRef(null);le({enabled:R&&H&&h.length>1,leftElRef:B,rightElRef:s,onLeft:v,onRight:E,dragThreshold:Math.max(40,Math.round(a*.05)),tapThreshold:12});const c=Math.max(140,Math.min(k,520)),l=i=>({left:`calc(50% ${i>=0?"+":"-"} ${Math.abs(i)}px)`,transform:"translateX(-50%)",width:`${c}px`,top:0,height:"100%"}),L=P?n:N,j=P?n:N;return h.length?x.jsx("div",{ref:M,"data-carousel-container":!0,"data-autoplay-scope":b,suppressHydrationWarning:!0,className:`w-full ${T}`.trim(),...g.props,children:R&&x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"relative overflow-visible w-full leading-none",style:{height:`${O}px`},children:[h.map((i,d)=>x.jsx(Se,{item:i,i:d,activeIndex:u,itemsLength:h.length,centerW:m,centerH:O,sideW:k,sideH:o,tx:n,onSelect:f,mediaChild:D[d]},i.slug??i.id??d)),H&&h.length>1&&x.jsxs(x.Fragment,{children:[x.jsx("div",{ref:B,className:"absolute z-30 cursor-grab touch-pan-x select-none",style:l(-L),"aria-hidden":"true","data-drag-zone":"left"}),x.jsx("div",{ref:s,className:"absolute z-30 cursor-grab touch-pan-x select-none",style:l(j),"aria-hidden":"true","data-drag-zone":"right"})]}),F&&h.length>1&&x.jsxs(x.Fragment,{children:[x.jsx(ie,{onClick:v,variant:"floating",position:{left:W,top:"50%",transform:"translate(-50%, -50%)"}}),x.jsx(ue,{onClick:E,variant:"floating",position:{left:Y,top:"50%",transform:"translate(-50%, -50%)"}})]})]}),z&&h.length>1&&x.jsx("nav",{className:"mt-6 flex justify-center gap-3","aria-label":"Carousel Pagination",children:h.map((i,d)=>x.jsx("button",{type:"button",onClick:()=>f(d),className:`w-3 h-3 rounded-full transition-all duration-300 ${d===u?"bg-primary scale-[1.30]":"faded-bg"}`,"aria-label":`Go to slide ${d+1}`},d))})]})}):null}export{Ce as default};
