import{j as e,r as i}from"./react-core.D5E039p9.js";import{B as H}from"./accordion.CB_fQFI-.js";import"./ui-primitives.Cy3ktW7z.js";import"./visibility-hooks.Dc_3xkZI.js";import"./engagement-hooks.GjbVtlvX.js";const J={success:"bg-green-50 text-green-800 border border-green-200",error:"bg-red-50 text-red-800 border border-red-200",loading:"bg-primary/10 text-primary border border-primary-200"},K={success:"✓",error:"⚠️",loading:""};function E({type:r,children:n,onDismiss:m}){return r==="loading"?e.jsxs("div",{className:"flex items-center justify-center p-4 mb-4",role:"status","aria-live":"polite",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-MainDark"}),e.jsx("span",{className:"ml-3 text-text",children:n})]}):e.jsx("div",{className:`p-4 rounded-lg mb-4 ${J[r]}`,role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"flex-shrink-0","aria-hidden":"true",children:K[r]}),e.jsx("div",{className:"flex-1",children:n})]}),m&&e.jsx("button",{type:"button",onClick:m,className:"flex-shrink-0 ml-4 text-current opacity-50 hover:opacity-100 transition-opacity","aria-label":"Dismiss message",children:"✕"})]})})}function O({children:r,onDismiss:n}){return e.jsx(E,{type:"success",onDismiss:n,children:r})}function Q({children:r,onDismiss:n}){return e.jsx(E,{type:"error",onDismiss:n,children:r})}function X({children:r}){return e.jsx(E,{type:"loading",children:r})}const Y=i.createContext(null);function Z({name:r,label:n,children:m,required:p=!1,containerClassName:v="mb-4",labelClassName:N="flex items-center gap-1.5 cursor-pointer",checkboxClassName:S="w-4 h-4 text-primary border-surface accent-accent rounded mt-0.5",...C}){const b=m??n;return e.jsx("div",{className:v,children:e.jsxs("label",{className:N,children:[e.jsx("input",{type:"checkbox",id:r,name:r,className:S,required:p,...C}),b&&e.jsxs("span",{className:"text-text",children:[b,p&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]})})}function ne({children:r,onSubmit:n,successMessage:m="Form submitted successfully!",errorMessage:p="An error occurred. Please try again.",loadingMessage:v="Submitting your form...",resetOnSuccess:N=!1,className:S="",onSuccess:C,onError:b,includeTermsCheckbox:L=!0,termsCheckboxLabel:R,termsCheckboxName:_="terms-agreement",privacyPolicyUrl:$="/privacy-policy",termsOfServiceUrl:q="/terms-of-service",submitButton:u}){const[l,F]=i.useState(!1),[M,f]=i.useState("idle"),[g,h]=i.useState(null),[t,y]=i.useState(0),w=i.useRef(null),k=i.Children.toArray(r).filter(s=>i.isValidElement(s)&&s.type.displayName==="FormStep"),a=k.length>0,c=a?k.length:1;i.useEffect(()=>{a&&w.current&&w.current.focus()},[t,a]);const U=s=>{a&&y(d=>Number.isNaN(s)?d:Math.max(0,Math.min(c-1,s)))},D=()=>{t<c-1&&y(s=>s+1)},A=()=>{t>0&&y(s=>s-1)},W=async s=>{s.preventDefault();const d=s.currentTarget;if(!d.checkValidity()){d.reportValidity();return}const V=new FormData(d);try{F(!0),f("submitting"),h(null);const o={};V.forEach((j,x)=>{const I=V.getAll(x);I.length>1?o[x]=I:d.querySelector(`[name="${x}"][type="checkbox"]`)?o[x]=j==="on":o[x]=j}),await n(o),f("success"),h(m),N&&(d.reset(),y(0)),C?.()}catch(o){f("error");const j=o instanceof Error?o.message:p;h(j),b?.(o instanceof Error?o:new Error("Unknown error"))}finally{F(!1)}},P=()=>{h(null),f("idle")},T=()=>a?k[t]:r,z=e.jsxs(e.Fragment,{children:["I agree to the"," ",e.jsx("a",{href:q,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:$,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:underline",children:"Privacy Policy"})]}),G=i.useMemo(()=>({isMultiStep:a,currentStep:t,totalSteps:c,isFirstStep:t===0,isLastStep:t===c-1,isSubmitting:l,nextStep:D,previousStep:A,goToStep:U}),[t,l,a,c]);return e.jsx(Y.Provider,{value:G,children:e.jsxs("form",{onSubmit:W,className:S,noValidate:!1,children:[M==="submitting"&&e.jsx(X,{children:v}),M==="success"&&g&&e.jsx(O,{onDismiss:P,children:g}),M==="error"&&g&&e.jsx(Q,{onDismiss:P,children:g}),a?e.jsx("div",{ref:w,tabIndex:-1,"aria-live":"polite","aria-atomic":"true",className:"outline-none",children:T()}):T(),L&&(!a||t===c-1)&&e.jsx(Z,{name:_,required:!0,containerClassName:"mt-2 mx-1",children:R??z}),!a&&u&&e.jsx("div",{className:"mt-6",children:e.jsx(H,{type:"submit",variant:u.variant??"primary",disabled:l||u.disabled,className:u.className,children:l?u.loadingText??"Submitting...":u.text??"Submit"})}),a&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t",children:[t>0?e.jsx("button",{type:"button",onClick:A,disabled:l,className:"px-6 py-2 border border-surface rounded-lg text-text hover:bg-text/5 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}):e.jsx("div",{}),e.jsxs("div",{className:"text-sm text-text",children:["Step ",t+1," of ",c]}),t<c-1?e.jsx("button",{type:"button",onClick:D,disabled:l,className:"px-6 py-2 bg-primary text-bg rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsx("button",{type:"submit",disabled:l,className:"px-6 py-2 bg-green-600 text-bg rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Submitting...":"Submit"})]})]})})}export{ne as default};
