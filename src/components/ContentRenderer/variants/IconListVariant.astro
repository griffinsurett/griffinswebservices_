---
import type { BaseVariantProps } from "../ContentRenderer.types";
import IconListItem from "@/components/LoopComponents/IconListItem";
import SectionHeader from "@/components/SectionHeader.astro";
import { toArray } from "@/utils/array";

interface Props extends BaseVariantProps {
  columns?: 1 | 2 | 3;
  gap?: "sm" | "md" | "lg";
}

const {
  items = [],
  title,
  collectionTitle,
  description,
  className = "",
  columns = 2,
  gap = "lg",
  id,
} = Astro.props as Props;

const safeItems = toArray(items);
const showHeader = Boolean(title ?? collectionTitle ?? description);

const gapClasses: Record<"sm" | "md" | "lg", string> = {
  sm: "gap-6",
  md: "gap-8",
  lg: "gap-10",
};
---

<section id={id} class={`py-16 ${className}`.trim()}>
  <div class="mx-auto inner-section">
    <div
      class={`flex flex-col lg:space-x-25 gap-6 ${
        showHeader ? "lg:flex-row lg:items-start" : ""
      }`.trim()}
    >
      {showHeader && (
        <div class="w-full lg:w-1/3 lg:sticky lg:top-0 lg:self-start">
          <SectionHeader
            title={title ?? collectionTitle}
            heading={title ?? collectionTitle}
            description={description}
            className="space-y-4 text-left"
            headingClassName="h2 text-heading"
            descriptionClassName="text-base text-muted leading-relaxed"
            titleVisibleRootMargin={0}
          />
        </div>
      )}

      {safeItems.length > 0 && (
        <div class={`w-full py-6 lg:py-0 ${showHeader ? "lg:w-2/3" : ""}`.trim()}>
          <ul class={`flex flex-col ${gapClasses[gap]} list-none`.trim()}>
            {safeItems.map((item) => (
              <li class="h-full">
              <IconListItem
                data={item}
                layout="vertical"
                alignment="left"
                className="items-start text-left gap-4"
                iconClassName="icon-large card-icon-color"
                iconSize="xl"
                titleClassName="h3 text-heading mb-1"
                descriptionClassName="text-base text-muted leading-relaxed"
              />
            </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  </div>
</section>
