import{r as i,j as t}from"./react-core.D5E039p9.js";import{M as T}from"./Modal.Dectr47X.js";import{u as S,e as g}from"./scriptManager.CZt_kULO.js";import{B as r,A as E}from"./accordion.Bbi0RoQs.js";import{T as M}from"./ToggleControl.cx0oUKq-.js";import{I as A}from"./ui-primitives.3avK0gLh.js";import"./consent.DDw29qdq.js";import"./visibility-hooks.JsR5xPa4.js";import"./engagement-hooks.CM_iKjxM.js";const y=[{id:"necessary",title:"Strictly Necessary Cookies",description:"These cookies are essential for the website to function properly. They enable core functionality such as security, network management, and accessibility.",required:!0},{id:"functional",title:"Functional Cookies",description:"These cookies enable the website to provide enhanced functionality and personalization. They may be set by us or by third party providers."},{id:"performance",title:"Performance Cookies",description:"These cookies allow us to count visits and traffic sources so we can measure and improve the performance of our site."},{id:"targeting",title:"Targeting Cookies",description:"These cookies may be set through our site by our advertising partners to build a profile of your interests and show you relevant adverts."}];function L({isOpen:l,onClose:a}){const{getCookie:d,setCookie:m}=S(),[f,u]=i.useTransition(),k=i.useMemo(()=>{const e=d("cookie-consent");if(e)try{return JSON.parse(e)}catch(s){console.error("Failed to parse cookie consent:",s)}return{necessary:!0,functional:!1,performance:!1,targeting:!1,timestamp:Date.now()}},[d]),[h,v]=i.useState(k),[P,b]=i.useState(!1),p=i.useRef(null);i.useEffect(()=>{const e=p.current;if(!e)return;const s=()=>{const n=e.scrollHeight>e.clientHeight,o=e.scrollTop+e.clientHeight>=e.scrollHeight-10;b(n&&!o)};return s(),e.addEventListener("scroll",s,{passive:!0}),window.addEventListener("resize",s,{passive:!0}),()=>{e.removeEventListener("scroll",s),window.removeEventListener("resize",s)}},[l]);const x=y.map((e,s)=>({slug:e.id,title:e.title,description:e.description,contentSlotId:`cookie-category-${s}-content`})),w=(e,s)=>{e!=="necessary"&&v(n=>({...n,[e]:typeof s=="boolean"?s:!n[e]}))},j=()=>{const e={necessary:!0,functional:!1,performance:!1,targeting:!1,timestamp:Date.now()};m("cookie-consent",JSON.stringify(e),{expires:365}),g(),window.dispatchEvent(new Event("consent-changed")),u(()=>{a()})},N=()=>{const e={...h,timestamp:Date.now()};m("cookie-consent",JSON.stringify(e),{expires:365}),g(),window.dispatchEvent(new Event("consent-changed")),u(()=>{a()})};return t.jsxs(T,{isOpen:l,onClose:a,closeButton:!0,className:"bg-bg rounded-2xl p-8 max-w-3xl w-full mx-4 max-h-[90vh] flex flex-col shadow-2xl",overlayClass:"bg-black/60",ariaLabel:"Manage cookie consent preferences",ssr:!1,children:[t.jsxs("div",{className:"mb-6 shrink-0",children:[t.jsx("h2",{className:"text-3xl font-bold text-heading mb-4",children:"Manage Consent Preferences"}),t.jsxs("p",{className:"text-text text-xs lg:text-sm leading-relaxed mb-3",children:["We use cookies and similar technologies to help personalize content and offer a better experience. You can click"," ",t.jsx(r,{variant:"link",href:"/cookie-policy",children:"here"})," ","to find out more and change our default settings. However, blocking some types of cookies may impact your experience of the site and the services we are able to offer."]}),t.jsxs(r,{variant:"link",href:"/cookie-policy",children:["More information",t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),t.jsx("div",{className:"relative flex-1 min-h-0",children:t.jsxs("div",{ref:p,className:"overflow-y-auto max-h-[40vh] pr-2",children:[t.jsx(E,{allowMultiple:!0,className:"space-y-3",items:x,showIndicator:!1,headerSlot:({item:e,id:s,expanded:n})=>{const o=y.find(c=>c.id===e.slug);if(!o)return null;const C=`${s}-toggle`;return t.jsxs("div",{className:"flex items-center gap-3 w-full",children:[t.jsx("div",{className:`w-9 h-9 rounded-full flex items-center justify-center transition-all duration-500 text-lg font-semibold ${n?"bg-primary text-bg":"bg-primary/20 text-accent"}`,"aria-hidden":"true",children:t.jsx(A,{icon:n?"lucide:minus":"lucide:plus",size:"sm",className:"w-4 h-4"})}),t.jsx("span",{className:"font-semibold text-heading text-base flex-1",children:o.title}),t.jsxs("div",{className:"shrink-0 flex items-center gap-3",children:[o.required&&t.jsx("span",{className:"text-sm font-semibold text-primary",children:"Always Active"}),t.jsx(M,{label:o.title,description:o.description,checked:h[o.id],onChange:c=>w(o.id,c),disabled:o.required,id:C,bordered:!1,className:"py-0",hideText:!0,size:"lg"})]})]})}}),x.map((e,s)=>t.jsx("div",{id:`cookie-category-${s}-content`,style:{display:"none"},children:t.jsx("p",{className:"text-sm text-text leading-relaxed",children:e.description})},e.slug))]})}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-6 pt-4 shrink-0",children:[t.jsx(r,{variant:"secondary",onClick:j,className:"flex-1",type:"button",disabled:f,children:"Reject All"}),t.jsx(r,{variant:"primary",onClick:N,className:"flex-1",animated:!1,type:"button",disabled:f,children:"Confirm My Choices"})]})]})}const O=i.memo(L);export{O as default};
