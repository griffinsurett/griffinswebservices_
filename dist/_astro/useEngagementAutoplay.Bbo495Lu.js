import{r as e}from"./react-core.BKcrIQ47.js";import{a as M,f as V}from"./useVisibility.Dfexy_Di.js";function q({totalItems:i,currentIndex:m,setIndex:y,autoplayTime:f=3e3,loop:d=!0,enabled:E=!0}){const n=e.useRef(null),s=e.useCallback(()=>{n.current&&(clearTimeout(n.current),n.current=null)},[]),l=e.useCallback(()=>{if(i<=1)return;const r=m+1,u=r>=i?d?0:Math.max(i-1,0):r;y(u)},[m,d,y,i]),h=e.useCallback(()=>{try{return typeof f=="function"?f():f}catch{return 3e3}},[f]),c=e.useCallback(()=>{if(s(),!E||i<=1)return;const r=Math.max(0,Number(h())||0);n.current=setTimeout(l,r)},[l,s,E,h,i]);return e.useEffect(()=>(c(),s),[c,s]),{schedule:c,clearTimer:s,advance:l}}const D=({initialPausedState:i=!1,resumeTriggers:m=["scroll","click-outside","hover-away"],resumeDelay:y=5e3}={})=>{const[f,d]=e.useState(i),[E,n]=e.useState(!1),[s,l]=e.useState(!1),[h,c]=e.useState(!1),r=e.useRef(null),u=e.useCallback(()=>{r.current&&(clearTimeout(r.current),r.current=null),c(!1)},[]),a=e.useCallback(()=>{u(),c(!0),r.current=setTimeout(()=>{c(!1),n(!1),l(!1),d(!1)},y)},[u,y]),v=e.useCallback(()=>d(!0),[]),P=e.useCallback(()=>{u(),d(!1),n(!1),l(!1)},[u]),b=e.useCallback(()=>d(p=>!p),[]),k=e.useCallback(()=>{u(),n(!0),l(!0)},[u]),o=e.useCallback(()=>{n(!1),l(!1)},[]),S=e.useCallback(()=>s&&E?(d(!0),!0):!1,[s,E]),w=e.useCallback(p=>{m.includes(p)&&(n(!1),l(!1),f&&a())},[f,m,a]);return e.useEffect(()=>()=>u(),[u]),{isPaused:f,userEngaged:E,shouldPauseAfterVideo:s,isResumeScheduled:h,scheduleResume:a,cancelScheduledResume:u,pause:v,resume:P,toggle:b,engageUser:k,disengageUser:o,pauseAfterVideoIfEngaged:S,handleResumeActivity:w}};function H({totalItems:i,currentIndex:m,setIndex:y,autoplayTime:f=3e3,resumeDelay:d=5e3,resumeTriggers:E=["scroll","click-outside","hover-away"],containerSelector:n="[data-autoplay-container]",itemSelector:s="[data-autoplay-item]",inView:l=!0,pauseOnEngage:h=!1,engageOnlyOnActiveItem:c=!1,activeItemAttr:r="data-active"}){const u=e.useRef(!1),{isPaused:a,userEngaged:v,isResumeScheduled:P,engageUser:b,handleResumeActivity:k,pause:o,resume:S}=D({initialPausedState:!1,resumeTriggers:E,resumeDelay:d}),{advance:w,schedule:p}=q({totalItems:i,currentIndex:m,setIndex:y,autoplayTime:f,enabled:!a&&l}),U=e.useCallback(()=>{u.current=!0,v&&!a&&o()},[o,v,a]);return e.useEffect(()=>{u.current=!1},[m]),e.useEffect(()=>{u.current&&v&&!a&&o()},[v,a,o]),M({scrollThreshold:10,debounceDelay:120,onScrollActivity:()=>k("scroll")}),V({containerSelector:n,itemSelector:s,onOutsideClick:()=>k("click-outside"),onInsideClick:()=>{},onItemClick:(C,R)=>{c&&!(R?.getAttribute(r)==="true")||(b(),h&&o())}}),e.useEffect(()=>{const C=Array.from(document.querySelectorAll(s));if(!C.length)return;const R=t=>!!t&&(!c||t.getAttribute(r)==="true"),g=t=>{const L=t.currentTarget;R(L)&&(b(),h&&o())},T=t=>{const L=t.relatedTarget?.closest?.(s)??null;R(L)||k("hover-away")};C.forEach(t=>{t.addEventListener("mouseenter",g),t.addEventListener("mouseleave",T)});const A=t=>{if(!v)return;const x=document.elementFromPoint(t.clientX,t.clientY)?.closest?.(s)??null;R(x)||k("hover-away")};return document.addEventListener("pointermove",A,{passive:!0}),()=>{C.forEach(t=>{t.removeEventListener("mouseenter",g),t.removeEventListener("mouseleave",T)}),document.removeEventListener("pointermove",A)}},[s,r,c,h,b,o,k,v]),e.useEffect(()=>{const C=document.querySelector(n);if(!C)return;const R=g=>{const A=g.detail?.phase,t=g.target?.closest?.(s);c&&!(t?.getAttribute(r)==="true")||(A==="start"?(b(),h&&!a&&o()):A==="end"&&k("scroll"))};return C.addEventListener("autoscroll-user",R),()=>C.removeEventListener("autoscroll-user",R)},[n,s,r,c,h,b,o,a,k]),e.useMemo(()=>({isAutoplayPaused:a,isResumeScheduled:P,userEngaged:v,pause:o,resume:S,engageUser:b,advance:w,schedule:p,beginGraceWindow:U}),[w,p,U,b,a,P,o,S,v])}export{H as u};
