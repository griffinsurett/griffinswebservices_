---
// src/pages/index.astro
import BaseLayout from "@/layouts/BaseLayout.astro";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import { siteData } from "@/content/siteData";
import AboutSection from "@/layouts/AboutSection.astro";
import {
  query,
  whereArrayContains,
  whereEquals,
  sortByDate,
  sortByOrder,
  sortBy,
} from "@/utils/query";
import FrontPageHero from "@/layouts/FrontPageHero.astro";
---

<BaseLayout title="Home" description={siteData.description}>
  <main class="flex-1">
    <!-- Hero ContentRenderer with static content -->
    <FrontPageHero
      title={siteData.tagline}
      description={siteData.description}
      primaryCTA={{
        text: "Get Started",
        link: "/contact-us",
      }}
    />

    <ContentRenderer query={query("projects")} variant="PortfolioVariant" />

    <ContentRenderer
      query={query("capabilities")
        .where((entry) => entry.data.parent === "website-services")
        .orderBy(sortByOrder())
        .limit(3)}
      variant="CardVariant"
      columns={3}
      gap="lg"
      title="Core Website Services"
      description="The three pillars every engagement includes: design, dependable engineering, and proactive care."
    />

    <AboutSection />

    <ContentRenderer
      query={query("benefits")}
      variant="BenefitsInlineVariant"
      title="Built different. Built better."
      description="Every site we build is intentionally crafted to load quickly, stay secure, and give your customers a smooth, frustration-free experience."
    />

    <!-- Capabilities - auto-populates from capabilities meta -->
    <ContentRenderer
      query={query("capabilities").orderBy(sortByOrder())}
      variant="CardVariant"
      columns={3}
      gap="lg"
    />

    <!-- Benefits - auto-populates from benefits meta -->
    <ContentRenderer query={query("benefits")} variant="CardVariant" />

    <!-- Solutions - auto-populates from solutions meta -->
    <ContentRenderer
      query={query("solutions").orderBy(sortByOrder())}
      variant="CardVariant"
      columns={3}
      gap="lg"
    />

    <!-- Filtered query - still gets meta from authors -->
    <!-- <ContentRenderer
      query={query("authors").where(whereArrayContains("tags", "featured"))}
      variant="CardVariant"
      columns={3}
      gap="lg"
    /> -->

    <!-- Portfolio with sorting -->
    <!-- <ContentRenderer
      query={query("projects")
        .orderBy(sortByDate("publishDate", "desc"))
        .limit(5)}
      variant="CardVariant"
    /> -->

    <!-- Testimonials with rating filter -->
    <ContentRenderer
      query={query("testimonials").where((entry) => entry.data.rating >= 4)}
      variant="TestimonialCarouselVariant"
    />

    <!-- Addon Capabilities - auto-populates from capabilities meta -->
    <ContentRenderer
      query={query("stats")}
      variant="CardVariant"
      columns={3}
      gap="lg"
    />

    <!-- Addon Capabilities - auto-populates from capabilities meta -->
    <ContentRenderer
      query={query("capabilities").orderBy(sortByOrder())}
      variant="CardVariant"
      columns={3}
      gap="lg"
    />

    <ContentRenderer
      query={query("technologies").orderBy(sortByOrder())}
      variant="TechnologiesVariant"
    />

    <!-- FAQ ContentRenderer -->
    <ContentRenderer
      query={query("faq").orderBy(sortByOrder())}
      variant="AccordionVariant"
      allowMultiple={false}
    />

    <!-- Contact ContentRenderer -->
    <!-- <ContentRenderer
      query={query("contact-us")}
      variant="ContactVariant"
      columns={2}
    /> -->

    <!-- Blog with limit - auto-populates from blog meta -->
    <!-- <ContentRenderer
      query={query("blog").limit(2)}
      variant="BlogVariant"
      columns={2}
    /> -->

    <!-- Multi-collection query - requires manual title/description -->
    <!-- <ContentRenderer
      query={query(["blog", "projects"]).orderBy(sortByDate()).limit(10)}
      variant="ListVariant"
      title="Recent Updates"
      description="Latest from our blog and portfolio"
    /> -->
  </main>
</BaseLayout>
