import{r as e}from"./react-core.lhpfgRL0.js";import{a as x}from"./useVisibility.Cx5WauJp.js";function M({totalItems:l,currentIndex:m,setIndex:E,autoplayTime:i=3e3,loop:f=!0,enabled:v=!0}){const t=e.useRef(null),s=e.useCallback(()=>{t.current&&(clearTimeout(t.current),t.current=null)},[]),a=e.useCallback(()=>{if(l<=1)return;const c=m+1,n=c>=l?f?0:Math.max(l-1,0):c;E(n)},[m,f,E,l]),o=e.useCallback(()=>{try{return typeof i=="function"?i():i}catch{return 3e3}},[i]),u=e.useCallback(()=>{if(s(),!v||l<=1)return;const c=Math.max(0,Number(o())||0);t.current=setTimeout(a,c)},[a,s,v,o,l]);return e.useEffect(()=>(u(),s),[u,s]),{schedule:u,clearTimer:s,advance:a}}const V=({initialPausedState:l=!1,resumeTriggers:m=["scroll","click-outside","hover-away"],resumeDelay:E=5e3}={})=>{const[i,f]=e.useState(l),[v,t]=e.useState(!1),[s,a]=e.useState(!1),[o,u]=e.useState(!1),c=e.useRef(null),n=e.useCallback(()=>{c.current&&(clearTimeout(c.current),c.current=null),u(!1)},[]),d=e.useCallback(()=>{n(),u(!0),c.current=setTimeout(()=>{u(!1),t(!1),a(!1),f(!1)},E)},[n,E]),b=e.useCallback(()=>f(!0),[]),P=e.useCallback(()=>{n(),f(!1),t(!1),a(!1)},[n]),k=e.useCallback(()=>f(y=>!y),[]),C=e.useCallback(()=>{n(),t(!0),a(!0)},[n]),h=e.useCallback(()=>{t(!1),a(!1)},[]),S=e.useCallback(()=>s&&v?(f(!0),!0):!1,[s,v]),T=e.useCallback(y=>{m.includes(y)&&(t(!1),a(!1),i&&d())},[i,m,d]);return e.useEffect(()=>()=>n(),[n]),{isPaused:i,userEngaged:v,shouldPauseAfterVideo:s,isResumeScheduled:o,scheduleResume:d,cancelScheduledResume:n,pause:b,resume:P,toggle:k,engageUser:C,disengageUser:h,pauseAfterVideoIfEngaged:S,handleResumeActivity:T}},D=({containerSelector:l="[data-container]",itemSelector:m="[data-item]",onOutsideClick:E=()=>{},onInsideClick:i=()=>{},onItemClick:f=()=>{},trustedOnly:v=!0}={})=>(e.useEffect(()=>{const t=s=>{if(v&&!s.isTrusted)return;const a=s.target,o=a?.closest?.(l)??null,u=a?.closest?.(m)??null;if(!o){E(s);return}i(s,o),f(s,u,o)};return document.addEventListener("click",t),()=>document.removeEventListener("click",t)},[l,m,i,E,f,v]),{triggerClick:t=>{document.querySelector(t)?.click?.()}});function H({totalItems:l,currentIndex:m,setIndex:E,autoplayTime:i=3e3,resumeDelay:f=5e3,resumeTriggers:v=["scroll","click-outside","hover-away"],containerSelector:t="[data-autoplay-container]",itemSelector:s="[data-autoplay-item]",inView:a=!0,pauseOnEngage:o=!1,engageOnlyOnActiveItem:u=!1,activeItemAttr:c="data-active"}){const n=e.useRef(!1),{isPaused:d,userEngaged:b,isResumeScheduled:P,engageUser:k,handleResumeActivity:C,pause:h,resume:S}=V({initialPausedState:!1,resumeTriggers:v,resumeDelay:f}),{advance:T,schedule:y}=M({totalItems:l,currentIndex:m,setIndex:E,autoplayTime:i,enabled:!d&&a}),U=e.useCallback(()=>{n.current=!0,b&&!d&&h()},[h,b,d]);return e.useEffect(()=>{n.current=!1},[m]),e.useEffect(()=>{n.current&&b&&!d&&h()},[b,d,h]),x({scrollThreshold:10,debounceDelay:120,onScrollActivity:()=>C("scroll")}),D({containerSelector:t,itemSelector:s,onOutsideClick:()=>C("click-outside"),onInsideClick:()=>{},onItemClick:(g,R)=>{u&&!(R?.getAttribute(c)==="true")||(k(),o&&h())}}),e.useEffect(()=>{const g=Array.from(document.querySelectorAll(s));if(!g.length)return;const R=r=>!!r&&(!u||r.getAttribute(c)==="true"),L=r=>{const A=r.currentTarget;R(A)&&(k(),o&&h())},w=r=>{const A=r.relatedTarget?.closest?.(s)??null;R(A)||C("hover-away")};g.forEach(r=>{r.addEventListener("mouseenter",L),r.addEventListener("mouseleave",w)});const p=r=>{if(!b)return;const q=document.elementFromPoint(r.clientX,r.clientY)?.closest?.(s)??null;R(q)||C("hover-away")};return document.addEventListener("pointermove",p,{passive:!0}),()=>{g.forEach(r=>{r.removeEventListener("mouseenter",L),r.removeEventListener("mouseleave",w)}),document.removeEventListener("pointermove",p)}},[s,c,u,o,k,h,C,b]),e.useEffect(()=>{const g=document.querySelector(t);if(!g)return;const R=L=>{const p=L.detail?.phase,r=L.target?.closest?.(s);u&&!(r?.getAttribute(c)==="true")||(p==="start"?(k(),o&&!d&&h()):p==="end"&&C("scroll"))};return g.addEventListener("autoscroll-user",R),()=>g.removeEventListener("autoscroll-user",R)},[t,s,c,u,o,k,h,d,C]),e.useMemo(()=>({isAutoplayPaused:d,isResumeScheduled:P,userEngaged:b,pause:h,resume:S,engageUser:k,advance:T,schedule:y,beginGraceWindow:U}),[T,y,U,k,d,P,h,S,b])}export{H as u};
