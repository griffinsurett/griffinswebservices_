---
// src/layouts/collections/SolutionsLayout.astro
/**
 * Solutions Layout - Item Page Layout for Solutions
 *
 * A specialized layout for solution-type collection items.
 * Features:
 * - QuoteHero with title, description, and quote form
 * - MDX content rendering
 * - Related capabilities section
 */
import BaseLayout from "@/layouts/BaseLayout.astro";
import QuoteHero from "@/layouts/QuoteHero.astro";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import { query, related } from "@/utils/query";
import { capitalizeWords } from "@/utils/string";
import type { CollectionLayoutProps } from "./types";
import DoubleCard from "../DoubleCard.astro";

const {
  entry,
  collection,
  collectionMeta,
  Content,
  isIndexPage,
  seoProps = {},
  ...extraProps
} = Astro.props as CollectionLayoutProps;

const data = entry?.data || {};
const {
  title,
  description,
  price,
  parent,
  heading,
} = data;

// Get the current entry's slug for filtering related capabilities
const currentSlug = entry?.id;

// Build the description with price if available
const heroDescription = price ? `${description} ${price}` : description;

// Capitalize the slug for display
const displayTitle =
  title || capitalizeWords(entry?.slug?.replace(/-/g, " ") || "");
---

<BaseLayout {...seoProps}>
    {/* Quote Hero Section */}
    <QuoteHero
      title={title}
      heading={heading}
      description={heroDescription}
      primaryCTA={{
        text: `View All ${collectionMeta?.data?.title || "Solutions"}`,
        link: `/${collection}`,
        rightIcon: "lu:arrow-left",
      }}
      id="solutions-quote-hero"
    />

    {/* MDX Content */}
    {Content && <Content />}

    <DoubleCard />

    <ContentRenderer
      query={related("capabilities", "solutions", currentSlug)}
      variant="IconListVariant"
      title="What's Included"
      heading={{
        before: "Everything included in your",
        text: displayTitle,
        after: "build.",
      }}
      description={`No surprises, no upsellsâ€”just the full package to get your ${displayTitle.toLowerCase()} live and performing.`}
      ctaHref="#solutions-quote-hero"
      ctaText="Get Your Free Quote"
      columns={2}
    />
</BaseLayout>
