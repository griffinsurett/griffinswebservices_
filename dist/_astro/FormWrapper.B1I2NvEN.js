import{j as e,r as c}from"./react-core.INjS0cla.js";import{B as G}from"./accordion.CrY4pn0C.js";import"./ui-primitives.YsNo9MyY.js";import"./visibility-hooks.Cl1L1XKD.js";import"./engagement-hooks.ChazTTXB.js";const H={success:"bg-green-50 text-green-800 border border-green-200",error:"bg-red-50 text-red-800 border border-red-200",loading:"bg-primary/10 text-primary border border-primary-200"},J={success:"✓",error:"⚠️",loading:""};function k({type:r,children:a,onDismiss:m}){return r==="loading"?e.jsxs("div",{className:"flex items-center justify-center p-4 mb-4",role:"status","aria-live":"polite",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-MainDark"}),e.jsx("span",{className:"ml-3 text-text",children:a})]}):e.jsx("div",{className:`p-4 rounded-lg mb-4 ${H[r]}`,role:"alert","aria-live":"polite",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"flex-shrink-0","aria-hidden":"true",children:J[r]}),e.jsx("div",{className:"flex-1",children:a})]}),m&&e.jsx("button",{type:"button",onClick:m,className:"flex-shrink-0 ml-4 text-current opacity-50 hover:opacity-100 transition-opacity","aria-label":"Dismiss message",children:"✕"})]})})}function K({children:r,onDismiss:a}){return e.jsx(k,{type:"success",onDismiss:a,children:r})}function O({children:r,onDismiss:a}){return e.jsx(k,{type:"error",onDismiss:a,children:r})}function Q({children:r}){return e.jsx(k,{type:"loading",children:r})}const X=c.createContext(null);function Y({name:r,label:a,children:m,required:p=!1,containerClassName:v="mb-4",labelClassName:N="flex items-center gap-1.5 cursor-pointer",checkboxClassName:S="w-4 h-4 text-primary border-surface accent-accent rounded mt-0.5",...M}){const b=m??a;return e.jsx("div",{className:v,children:e.jsxs("label",{className:N,children:[e.jsx("input",{type:"checkbox",id:r,name:r,className:S,required:p,...M}),b&&e.jsxs("span",{className:"text-text",children:[b,p&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})]})})}function ae({children:r,onSubmit:a,successMessage:m="Form submitted successfully!",errorMessage:p="An error occurred. Please try again.",loadingMessage:v="Submitting your form...",resetOnSuccess:N=!1,className:S="",onSuccess:M,onError:b,includeTermsCheckbox:V=!0,termsCheckboxLabel:L,termsCheckboxName:I="terms-agreement",privacyPolicyUrl:_="/privacy-policy",termsOfServiceUrl:$="/terms-of-service",submitButton:u}){const[i,E]=c.useState(!1),[w,f]=c.useState("idle"),[g,h]=c.useState(null),[s,y]=c.useState(0),C=c.Children.toArray(r).filter(t=>c.isValidElement(t)&&t.type.displayName==="FormStep"),o=C.length>0,l=o?C.length:1,q=t=>{o&&y(d=>Number.isNaN(t)?d:Math.max(0,Math.min(l-1,t)))},F=()=>{s<l-1&&y(t=>t+1)},D=()=>{s>0&&y(t=>t-1)},R=async t=>{t.preventDefault();const d=t.currentTarget;if(!d.checkValidity()){d.reportValidity();return}const P=new FormData(d);try{E(!0),f("submitting"),h(null);const n={};P.forEach((j,x)=>{const T=P.getAll(x);T.length>1?n[x]=T:d.querySelector(`[name="${x}"][type="checkbox"]`)?n[x]=j==="on":n[x]=j}),await a(n),f("success"),h(m),N&&(d.reset(),y(0)),M?.()}catch(n){f("error");const j=n instanceof Error?n.message:p;h(j),b?.(n instanceof Error?n:new Error("Unknown error"))}finally{E(!1)}},A=()=>{h(null),f("idle")},U=()=>o?C[s]:r,W=e.jsxs(e.Fragment,{children:["I agree to the"," ",e.jsx("a",{href:$,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:underline",children:"Terms of Service"})," ","and"," ",e.jsx("a",{href:_,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:underline",children:"Privacy Policy"})]}),z=c.useMemo(()=>({isMultiStep:o,currentStep:s,totalSteps:l,isFirstStep:s===0,isLastStep:s===l-1,isSubmitting:i,nextStep:F,previousStep:D,goToStep:q}),[s,i,o,l]);return e.jsx(X.Provider,{value:z,children:e.jsxs("form",{onSubmit:R,className:S,noValidate:!1,children:[w==="submitting"&&e.jsx(Q,{children:v}),w==="success"&&g&&e.jsx(K,{onDismiss:A,children:g}),w==="error"&&g&&e.jsx(O,{onDismiss:A,children:g}),U(),V&&(!o||s===l-1)&&e.jsx(Y,{name:I,required:!0,containerClassName:"mt-6",children:L??W}),!o&&u&&e.jsx("div",{className:"mt-6",children:e.jsx(G,{type:"submit",variant:u.variant??"primary",disabled:i||u.disabled,className:u.className,children:i?u.loadingText??"Submitting...":u.text??"Submit"})}),o&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t",children:[s>0?e.jsx("button",{type:"button",onClick:D,disabled:i,className:"px-6 py-2 border border-surface rounded-lg text-text hover:bg-text/5 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}):e.jsx("div",{}),e.jsxs("div",{className:"text-sm text-text",children:["Step ",s+1," of ",l]}),s<l-1?e.jsx("button",{type:"button",onClick:F,disabled:i,className:"px-6 py-2 bg-primary text-bg rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"}):e.jsx("button",{type:"submit",disabled:i,className:"px-6 py-2 bg-green-600 text-bg rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Submitting...":"Submit"})]})]})})}export{ae as default};
