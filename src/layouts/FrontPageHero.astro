---
// src/layouts/FrontPageHero.astro
// Hero with TextHero layout + Portfolio showcase
import Button from "@/components/Button/Button";
import ContentRenderer from "@/components/ContentRenderer/ContentRenderer.astro";
import SectionHeader from "@/components/SectionHeader.astro";
import ScrollIndicator from "@/components/ScrollIndicator.astro";
import { query } from "@/utils/query";
import { siteData } from "@/content/siteData";
import type { HeadingContent } from "@/content/schema";

interface CTA {
  text: string;
  link: string;
  rightIcon?: string;
}

export interface Props {
  heading?: HeadingContent;
  description?: string;
  primaryCTA?: CTA;
  className?: string;
  id?: string;
  scrollToSection?: string;
}

const defaultDescription =
  "Hand-crafted websites, automated systems, and ongoing support so you can sell more, grow faster, and stay secure without juggling multiple vendors.";

const {
  heading,
  description = siteData.description ?? defaultDescription,
  primaryCTA = {
    text: "Book An Intro Call",
    link: "#contact",
    rightIcon: "lu:arrow-right",
  },
  className = "",
  id = "hero",
  scrollToSection,
} = Astro.props as Props;
---

<section
  id={id}
  class={`min-h-screen flex items-center justify-center relative overflow-hidden ${className}`}
>
  <div class="relative z-10 min-h-screen inner-section flex items-center">
    <div class="mx-auto px-2 lg:px-0 max-w-6xl lg:max-w-7xl w-full py-20 lg:py-0">
      <div class="lg:flex lg:flex-row lg:items-center lg:gap-12 space-y-3 lg:space-y-8">
        <!-- Left side: Text content -->
        <div
          class="flex-1 flex flex-col gap-3 lg:gap-6 justify-center hero-content"
          data-animate="fade-in-up"
          data-animate-once="false"
        >
          <SectionHeader
            className="text-left lg:text-left w-full"
            heading={heading}
            headingTag="h1"
            headingClassName="text-4xl md:text-5xl"
            description={description ?? defaultDescription}
            descriptionClassName="text-lg lg:text-xl leading-relaxed max-w-3xl lg:max-w-none"
          />

          <div class="flex flex-col-reverse lg:flex-row items-start lg:items-center gap-3 lg:gap-6 lg:w-full">
            <ContentRenderer
              query={query("testimonials")
                .where((entry) => entry.data.featured === true)
                .limit(3)}
              variant="TestimonialCirclesVariant"
              className="px-2 md:px-0"
              counterStart={10}
              counterEnd={100}
              counterDuration={1800}
              counterSuffix="+"
              counterLabel="Happy Clients"
            />

            <Button
              href={primaryCTA.link}
              variant="primary"
              size="lg"
              rightIcon={primaryCTA.rightIcon}
            >
              {primaryCTA.text}
            </Button>
          </div>
        </div>

        <!-- Right side: Portfolio showcase -->
        <div
          class="flex-1 w-full hidden lg:block hero-portfolio"
          data-animate="fade-in"
          data-animate-once="true"
        >
          <ContentRenderer
            query={query("projects")}
            variant="PortfolioScreenVariant"
            responsivity={{ show: "lg" }}
          />
        </div>
      </div>
    </div>
  </div>

  <span class="hero-arrow" data-animate="fade-in" data-animate-once="false">
    <ScrollIndicator href={scrollToSection} />
  </span>
</section>

<style>
  /* Very fast animation on mobile for better Speed Index */
  .hero-content {
    --animation-duration: 250ms;
  }

  .hero-portfolio {
    --animation-delay: 300ms;
    --animation-duration: 400ms;
  }

  .hero-arrow {
    --animation-delay: 400ms;
    --animation-duration: 300ms;
  }

  /* Normal animation on desktop */
  @media (min-width: 1024px) {
    .hero-content {
      --animation-duration: 600ms;
    }

    .hero-portfolio {
      --animation-delay: 600ms;
      --animation-duration: 800ms;
    }

    .hero-arrow {
      --animation-delay: 800ms;
      --animation-duration: 800ms;
    }
  }
</style>
